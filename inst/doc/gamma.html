<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="N. Frerebeau" />

<meta name="date" content="2024-09-23" />

<title>Manual</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Manual</h1>
<h4 class="author">N. Frerebeau</h4>
<h4 class="date">2024-09-23</h4>


<div id="TOC">
<ul>
<li><a href="#overview" id="toc-overview"><span class="toc-section-number">1</span> Overview</a></li>
<li><a href="#import-file" id="toc-import-file"><span class="toc-section-number">2</span> Import file</a></li>
<li><a href="#inspect-spectrum" id="toc-inspect-spectrum"><span class="toc-section-number">3</span> Inspect spectrum</a></li>
<li><a href="#calibrate-the-energy-scale" id="toc-calibrate-the-energy-scale"><span class="toc-section-number">4</span> Calibrate the energy scale</a>
<ul>
<li><a href="#workflow" id="toc-workflow"><span class="toc-section-number">4.1</span> Workflow</a>
<ul>
<li><a href="#clean" id="toc-clean"><span class="toc-section-number">4.1.1</span> Clean</a></li>
<li><a href="#stabilization" id="toc-stabilization"><span class="toc-section-number">4.1.2</span> Stabilization</a></li>
<li><a href="#smoothing" id="toc-smoothing"><span class="toc-section-number">4.1.3</span> Smoothing</a></li>
<li><a href="#baseline-correction" id="toc-baseline-correction"><span class="toc-section-number">4.1.4</span> Baseline correction</a></li>
<li><a href="#peak-detection" id="toc-peak-detection"><span class="toc-section-number">4.1.5</span> Peak detection</a></li>
<li><a href="#energy-scale-calibration" id="toc-energy-scale-calibration"><span class="toc-section-number">4.1.6</span> Energy scale
calibration</a></li>
</ul></li>
<li><a href="#use-the-pipe" id="toc-use-the-pipe"><span class="toc-section-number">4.2</span> Use the pipe!</a></li>
</ul></li>
<li><a href="#estimate-the-gamma-dose-rate" id="toc-estimate-the-gamma-dose-rate"><span class="toc-section-number">5</span> Estimate the gamma dose
rate</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(gamma)</span></code></pre></div>
<div id="overview" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Overview</h1>
<p><strong>gamma</strong> is intended to process in-situ gamma-ray
spectrometry measurements for luminescence dating. This package allows
to import, inspect and (automatically) correct the energy scale of the
spectrum. It provides methods for estimating the gamma dose rate by the
use of a calibration curve. This package only supports Canberra CNF and
TKA files.</p>
<p>Typical workflow:</p>
<ol style="list-style-type: decimal">
<li>Import spectrum data with <code>read()</code>,</li>
<li>Inspect spectrum with <code>plot()</code>,</li>
<li>Calibrate the energy scale with
<code>energy_calibrate()</code>,</li>
<li>Estimate the gamma dose rate with <code>dose_predict()</code>.</li>
</ol>
<p>The estimation of the gamma dose rate requires a calibration curve.
This package contains several built-in curves, but as these are
instrument-specific you may need to build your own (see
<code>help(dose_fit)</code>). These built-in curves are in use in
several labs and can be used to reproduce published results. Check out
the dedicated vignette for an overview of the fitting process:
<code>vignette(&quot;doserate&quot;)</code></p>
<p>Note that <strong>gamma</strong> uses the <em>International System of
Units</em>: energy values are assumed to be in keV and dose rates in
µGy/y.</p>
</div>
<div id="import-file" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Import file</h1>
<p>Both Canberra CNF and TKA files can be imported.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Automatically skip the first channels</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Import a CNF file</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>cnf_test <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata/LaBr.CNF&quot;</span>, <span class="at">package =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>(spc_cnf <span class="ot">&lt;-</span> <span class="fu">read</span>(cnf_test))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; Gamma spectrum:</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; *  name: LaBr</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; *  date: 2019-02-07 11:48:18</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; *  live_time: 3385.54</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; *  real_time: 3403.67</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; *  channels: 1024</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; *  energy_min: -7</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; *  energy_max: 3124.91</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co"># Import a TKA file</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>tka_test <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata/LaBr.TKA&quot;</span>, <span class="at">package =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>(spc_tka <span class="ot">&lt;-</span> <span class="fu">read</span>(tka_test))</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; Gamma spectrum:</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; *  name: LaBr</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; *  date: 2024-09-23 21:26:10.596201</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; *  live_time: 3385.54</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; *  real_time: 3403.67</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; *  channels: 1024</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; *  energy_min: NA</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; *  energy_max: NA</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co"># Import all files in a given directory</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>files_test <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="at">package =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>(spc <span class="ot">&lt;-</span> <span class="fu">read</span>(files_test))</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt; A collection of 4 gamma spectra: BEGe, Kromek_CZT, LaBr, LaBr</span></span></code></pre></div>
</div>
<div id="inspect-spectrum" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Inspect spectrum</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Plot CNF spectrum</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">plot</span>(spc_cnf) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="calibrate-the-energy-scale" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Calibrate the energy
scale</h1>
<p>The energy calibration of a spectrum is the most tricky part. To do
this, you must specify the position of at least three observed peaks and
the corresponding energy value (in keV).</p>
<p>The package allows you to provide the channel-energy pairs you want
to use. However, the spectrum can be noisy so it is difficult to
properly determine the peak channel. In this case, a better approach may
be to pre-process the spectrum (variance-stabilization, smoothing and
baseline correction) and perform a peak detection. Once the identified
peaks are satisfactory, you can set the corresponding energy values (in
keV) and use these lines to calibrate the energy scale of the
spectrum.</p>
<p>Regardless of the approach you choose, it is strongly recommended to
check the result before proceeding.</p>
<div id="workflow" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Workflow</h2>
<p>The following steps illustrate how to properly fine-tune the
parameters for spectrum processing before peak detection.</p>
<div id="clean" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Clean</h3>
<p>Several channels can be dropped to retain only part of the spectrum.
If no specific value is provided, an attempt is made to define the
number of channels to skip at the beginning of the spectrum. This drops
all channels before the highest count maximum. This is intended to deal
with the artefact produced by the rapid growth of random background
noise towards low energies.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Use a square root transformation</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>sliced <span class="ot">&lt;-</span> <span class="fu">signal_slice</span>(spc_tka)</span></code></pre></div>
</div>
<div id="stabilization" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Stabilization</h3>
<p>The stabilization step aims at improving the identification of peaks
with a low signal-to-noise ratio. This particularly targets higher
energy peaks.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Use a square root transformation</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>transformed <span class="ot">&lt;-</span> <span class="fu">signal_stabilize</span>(sliced, <span class="at">f =</span> sqrt)</span></code></pre></div>
</div>
<div id="smoothing" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Smoothing</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Use a 21 point Savitzky-Golay-Filter to smooth the spectrum</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>smoothed <span class="ot">&lt;-</span> <span class="fu">signal_smooth</span>(transformed, <span class="at">method =</span> <span class="st">&quot;savitzky&quot;</span>, <span class="at">m =</span> <span class="dv">21</span>)</span></code></pre></div>
</div>
<div id="baseline-correction" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Baseline
correction</h3>
<p>The baseline estimation is performed using the SNIP algorithm <span class="citation">(Ryan et al. 1988; Morháč et al. 1997; Morháč and
Matoušek 2008)</span>. You can apply the LLS operator to your data, use
a decreasing clipping window or change the number of iterations (see
references).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Estimate the baseline of a single file</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> <span class="fu">signal_baseline</span>(smoothed, <span class="at">method =</span> <span class="st">&quot;SNIP&quot;</span>, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># Plot spectrum + baseline</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">plot</span>(smoothed, baseline) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Spectrum + baseline&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Substract the estimated baseline</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>corrected <span class="ot">&lt;-</span> smoothed <span class="sc">-</span> baseline</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># Or, remove the baseline in one go</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># corrected &lt;- removeBaseline(smoothed)</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co"># Plot the corrected spectrum</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="fu">plot</span>(corrected) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Baseline-corrected spectrum&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAADAFBMVEX///8AAADy8vKgoKD29vb6+vrz8/Pr6+v+/v7u7u709PT4+Pjw8PD8/Pzx8fH39/fJycmtra27u7vv7+/s7Oz9/f319fX7+/vNzc1xcXEBAQEEBAQCAgLt7e1/f3/MzMxcXFwMDAzg4ODZ2dmbm5sDAwNNTU00NDQICAhQUFBfX1/5+fm9vb1oaGhhYWHq6uq5ublMTExTU1MJCQnj4+Pd3d3U1NTIyMiUlJRaWlqSkpKdnZ1UVFR1dXV2dnbp6emIiIi/v79gYGC2trYGBgbR0dEFBQUREREODg44ODgQEBAPDw+qqqpnZ2eGhobi4uJqamrAwMAdHR2FhYXk5OTc3NwLCwsTExNsbGxubm4wMDCYmJhGRkYpKSnGxsY8PDx8fHyenp5+fn4NDQ0KCgoYGBhkZGRvb29wcHDX19ePj48UFBSCgoIkJCQXFxc5OTl6enqsrKy+vr4HBwfBwcFOTk7a2to6Ojrn5+czMzNZWVnDw8McHBypqamrq6vo6OiNjY2RkZGkpKQgICCcnJzExMS6urqfn58xMTGEhIQWFhawsLCHh4d9fX3Y2Ni4uLgfHx/FxcXm5uYjIyNRUVHCwsJISEg7OzuWlpaOjo4VFRU1NTV4eHgiIiJzc3M2NjZLS0syMjLQ0NBtbW3e3t7Ozs6Tk5NKSkpjY2PS0tJeXl55eXmzs7Pl5eWurq6MjIweHh7T09MZGRk/Pz8bGxsuLi60tLQrKyuioqISEhLf398aGhqnp6eysrIsLCw3NzdCQkJ7e3uQkJBXV1e1tbWBgYHLy8tFRUWVlZXV1dW3t7ddXV0hISEtLS1bW1tycnJERERBQUEqKipAQEAmJiZYWFiKioqDg4MoKCgvLy9VVVWLi4vb29uxsbGmpqZ3d3dSUlJPT09ra2s+Pj7KysqAgIChoaFlZWXh4eGoqKiamppHR0e8vLyZmZnPz8+Xl5ejo6NWVlbHx8dpaWmvr6/W1tZiYmJmZmYnJyc9PT1DQ0MlJSVJSUl0dHSlpaWJiYlhVgZVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR42uzdeXAUVR4H8N8vkkySnZlw5GDD5OKIQAgEAsgRQsIZI3KFIkC4yZIglxiu4jKcq9z3KQakALmRU0CBCiKHrC4sJWgtYG1UYAFxWUUWStz3uudorGSZlS58pL7fP3p6uh+/fv3647zugUQiBEEQBEEQBEEQBEEQBHn6acEi1c50DH5cwx5JRBdbmHvwhP7FbOxT98lrIKUI6C87dlxIchwJ8wJoz2RzD9435smBFlsDKUVAbfLlZ57uBVBnbCH/zxHshuVvBhr2eKC/OoKvPy5uKQK6lX8Qy36r0jLvLxArdeLnJ567LXd8t3Hl4KQqTqCHxRT/YreMGMfqJo/sc2ZrUdreSFluxu70RbUjxMrzuQmrop1LQ3Nnwz7i7mKHcfvytWlFr7mBujph5Yk1wtNvvPPoIR+poR9haLzcUSlFdDL+3UrZRxucuv/S/Cxc49IANDlc3ITO5i9vXTmTJmSNSe+2oojbEY3MW/VK+wlt/24AujM9Zcpwnmfcp+f98KUn11X6F1E7x5HCVwfM9xNAe2Z+Vt659DR3NZx7NzHqdcP2/nx0xd3qmS6grk5YefCub7451LU1lVhDP4IBaPa9pp8nzp855/tzjh9xkZ9toPmFhSnjsh+K9SMPBNYFfJPq8yvig+vcFaK1BWLT2PTGBqC8hMji2GLcpyXo0Boxq9bm+mGrn48jms7tBVBOJdfS3dzdUJ+e3dvHJo4S9w5vshOouxNWzmtA1CHmq5Jr6EcwAO26jegYbyDazlNwkZ/5p3jmA+JaUpy80/uA91Gd8N2Vtb0LuZ98GbfLAPSi3DIz17hPS6r8VKVrWQvf4+fk+4L/CDjn5Zq29DR3N9RwebZf5jvyVjLPCdTdCStr/w3E5/mXVMN5HAPQv4mVydyFqDlPw0V+9qd4yxZ5M0g3f657PlwApSEOx5Etm8SUqvPlNgagS+Uf+1OuYZ/PzZs3a9E01j3RJS4rX2rukVO8BlQuPc3dDTVcnu1D2E9uPO+a4l2dsPKb8u1J7lJSDedxDEBljUYcSBQMoKXiHpQu3pOP8kVzHpaXQGn07KOtwvOpLN+O0mIAWtcJ1LMvSpipRMvFfKtllg609jABp4YGVC49zd0NNVye7e11oD3cT/HOTlg5Q77L4oMl1XAeRwfqANDSCPT+LopwRIqVUwJoQENxEzm2IDvEwtpDcEJCMUAN+7TM4NfEskv8d5v4ffl++JhHgHqauxtquDzbP+AX5NdDaU6g7k5YOVq+X9fGVlINF9CXtVtXAC2FQC0v3aCv+RbJR/l9dJpnibV/xNhoWa8KROurJRcD1LBP/x7ywGKxzOCDvlMLfIl685BHgHqauxtS367G7c2za/hLVk6g7k5YubqYz7elbSy5hn6E/UfljQGAlr6n+MK+U8PHU+iwnflTxnXmn8b67DkQmfVJpX8TLcnb/8uK+cO6FAfUs0/PSY691ayV+LS7Hr6sUf807WsmA1BPc3fD2TxttGF7fz6xoWPifidQdyesnDkhI6Nz4vqSa+hHiOfuI3Kr5QFo6XuKHzC8llj/uE/M0By/mjFTqOGoYYm9ZosplqJ6Zg5LGk3FAfXsc6bd8JhFr5YRK/OK0lfrX9QbgBqauxpeO1J9uXH7ybUD+iTEu+5BXZ2w8uTj99L/uv5/1NCPYG8xmNtMvgigyFONlRt53TbAD+OFKAwUQQAUQYyJK3wHg4AgCIIgCIIgCIIgCIIgiFe5063xnDpEDbttrur6scwq5bRMmljOjIxoZ0qZSddNKVPOpJO6PkKh3pS7PsmcMTbppLy+4r0f77P5sSpBjY6TrXbroORU57bnbpWX2TervBmZsdWUMi23zzClzoemVEnYPk+h3pTf/pEpZfaZc1KXvD2rhD8+HmhqBlH9xlSxGdH4SBfQitpLYIApH9Eh5vxLjT9YzPmRdrspVWwWX4V6Q8FlTCkTGmZKGauPt6PoBdAgwafTHDrdhKhyR/Hep0mTJpELAmUqRASaEb8AU8rYLaaUCTTppCw+CvUmMNhqSpkKJp2Ut1fcnuOV4yU1B1G7qmK2jxZv6owaNapbpwCZ4OAAU2JOmQiLSr0JsESUwt5EmHRS3p6VZZ0XPH0u5FQmarlBfILGY4rHFK/aFO+b21Re+IpvEfXGPSiAKgd05Ba9ac0GIf1rASiAqga0aazIp0SDur/c1B9AAVQ1oMUFQAEUQAEUQAEUQAEUQAEUQAEUQAEUQAEUQAEUQAEUQAEUQAFUXaArBgIogKoLtA5zBwAFUGWBfsT8IYACqLJAhwyIOQ6gAKos0OhVPVoAKIAqC7So3pqeAAqgygKdmnt1P4ACqKpAQ1rlRx4AUABVFehCnvhPrg+gAKoo0NbcaStHASiAKgo0lTfd4RkACqCKAv2BO1ThdgAKoIoC7cd+wZwFoACqKNAVlfxDHLMBFEAVBTpnJVHbZAAFUEWBrntANHQggAKookCjC4gKkgAUQBUFGnuC6MYJAAVQRYEWJREtXgagAKoo0Dfuimn+DQAFUEWBDs0hir8HoACqKNCZfYne7gygAKoo0MRfiPofAFAAVRNoGN8mSskDUABVE2gATyHawEEACqBKAq3Ml+Q/GIkAUABVEuh7nEo0kTsAKIAqCbQ3R8nf3TAXQAFUSaAJXIWok1QKoACqINARvI3oYx4JoACqJNBvWZQ4xS0BFECVBNoo3EZ0kMsBKIAqCTQlWyya8/cA+rsB7de7jIw1oowZCa1gShkfiyllygQ8aYEtK8XCwifV6I2eYLspZeyB5pyUt1fcL+c3Ai3rK+MT4WtG4uymlAm1xJlSx/qkBXLOiEWQI1+N3ugJ9jOljF+QKWUqeHtWQbmY4s2fVK/ulZNTdgameNyDKgl03Bg5tJl9ARRAlQQa21MObefPABRAlQR69is5tOfjARRAlQS6arMc2i82AyiAKgm0V0c5tMPrASiAKgl0ZzM5tGfXACiAKgl0ZaQc2rpnARRAlQTaNUUO7ZdHABRAVQTq72gih3bzYQAFUBWBluFpcmivLgJQAFURaDBflkPbfQ+AAqiKQDvwLDm0zTIBFEBVBDqXE+TQzukKoACqItD1PF4ObXsHgAKoikCnsxwdWz7HASiAKgh0Bg+SQ3uSrQAKoAoCncXX5ND249cBFEAVBHqZLXJoH/JBAAVQBYFO41A5tOX4RwAFUAWBNgoPkUPbkisCKIAqCPTzRG1oa/ECAAVQBYEeP6AN7QK+CaAAqiDQt7S/hLdV5H0ACqAKAs0Zqg3tKZ4EoACqINCf/qINbQNzfjkTgAKoySQ+KdCGdhvfAlAAVRBovd3a0FqqTQZQAFUQ6MalOlDtR5MAFEBVA3p2sQ50cCSAAqiCQF9srAOdkAygAKog0C8G6kAfdANQAFUQ6Pl1OtC97wIogCoItHOyDlSf6gEUQBUDqj8c2Sz6wxKAAqhiQPWvl2wW/esmAAVQxYBWK9SB1isCUABVD2ic/lecNsunqwAUQNUDaudvdaADDwMogKoHtDlP1IF2XwSgAKoe0Gt8SQd65RCAAqh6QPVfzSSARrYF0KcEdIGvWLwdGxubBaCPTWv9fxRvs6RUB9CnA7TLMfmD3tE+vr42AH1sXuCvdaCF4f4A+jSApiTFCqBB0ZjivUon3qQDzeIgAH06U3w9AfRg9LrGFyTIELvdXjXKXyYwwN+M2PxMKRNkCTGljv3J/vhpriJfwix/5oDfvzeuBIeaUibU15QyVh8vG4Z5D3Ru+whb/uz/snfv4TGdeRzAz28kM5OIRJoRVhKXJJq41C3uQSlFLSIurUsjpQQhpWlDLI2iKaWuVXTdKcG2blta6pZa92u74kEsdSururbqWdpads7MnDNncs/MS347vt8/xsnEeZ8zJ5/nvO85c87vNf+QOmbMmDXJBiSf/EArrAv96RD2hosZv7LIQOWE7ZWP8v7+/h/e8ZPjE+InIh4+QprRGzyEtBPg2upfUQ/5n0BDGg0t+a1RYtIJacY3UEgzXkX9VN6Diww0LEySGlbBGLTQTCa9dQx6WEj1MIxBiwg0vfbz5SY0AdBCc5vKW4HG0ioAfXJAJf+EGomBAFpoEoOsu9bQmPoB6JMBmisAmn+6VLUBXUHJAAqg7IBWGmYDOoPaACiAsgN6sZsNaCitB1AAZQfUWtzODHQ8PQRQAGUHtPMuG9AAigZQAGUHtEaEDagfHQRQAGUHNCveBtSz7bsACqDsgFY/qQDt0B1AAZQd0HnLFKBTBwAogLID+u33CtCNLQAUQNkBHXFcAfp7bwAFUHZAp/xHAbqrM4ACKDugcV0VoBE1ABRA2QFdfEIBOj8LQAGUHdCv/6IA3TMXQAGUHdBt1xSgGQ8AFEDZAbXNPmMGOncPgAIoO6DW8qAy0Kz5AAqg3IB6Ul8F6AsRAAqg3IDqabICtPMuAAVQbkANtEMB2vt3AAVQbkAb0F0FaMuNAAqg3ID2tD0qZwY6fSqAAig3oJuotQL0gz8CKIByA7qf7ihAsyMBFEC5AR1L/1KArhZRwRZAAVQoiWdoqAL0JtUEUABlBvQz2q4A/YF8ARRAmQFNo1QF6DtUB0ABlBnQf1OAAnQaxQAogDIDGm6bOsEM9DD1BFAAZQZUOXU3A61FhwAUQJkBPW27+GkGmi6ixDKAAqhQEsM7qkD3U2MABVBmQDMHqUDXWidFBFAAZQR0ySQVaBi9D6AAygzo5TgV6Hb6DEABlBnQNVNUoHPoTQAFUGZAj49QgYbQBQAFUGZA63+rAvW2PZ4EoADKB+iyeSrQ8nQbQAGUGdCTl1SgUvAEAAVQZkB//dkONPI0gJYM0OixOjleJp2I+HoJacbHIKQZXYhLay/Psn0og4+uw/SS3ho1pgAhzQT4itnFRf2LB/TGEVTwMWvLdfsRdOp0HEHRxTMDer+XHWi3lgAKoMyATlpiB5o0GEABlBnQzSPtQL/7BUABlBnQbfvsQG3zKQAogPIBaqtfawH60nEABVBmQNsl2oH+tTmAAigvoGVogR3oq88CKIDyAhqoTBIvA005AKAAyguoF020Az13BUABlBfQVOUmZRnokd0ACqC8gIYqj3nIQBPOAiiA8gKqPignA+11BkABlBdQ9VFjGajyhCeAAigXoGqxBhlo5mYABVBeQNNtBZYtQIe3B1AA5QVULRgmAz0dBaAAygvo36ihHeiEYAAFUF5A11MPO9C+5AmgAMoK6A4y2IGWIj2AAigroKVIZweqagVQAGUC9Cdl6hkZqNrfAyiAMgHarKJkB9pGQJF6AAVQkSTU6Q9loCKK1AMogIokoU4gKwOdTRUAFEBZAVWn4JaBVqZ+AAqgrIBe7KYB2oiSARRAWQEdnKQBGkZ1ARRAWQF97ksNUBFF6gEUQEWSqL1cA/RzAUXqARRARZJoOkID1CSgSD2AAqhIEvX/rgGqo1IAKh7o7FDp7tzu5QHUmdT7UQO0NN0EUOFAP6GtN9pe6pgJoM7kQIoGqJGaAKhwoLOypQlTpHcmAagzuXJOA1Rq9wmACgcatV+69JrUKBJAncnuKlqgSqk7ABUItM+i82+lS80+AlBn0meNFmj74QAqHOjOdhVHG7sUPMUPgOaXuK5aoINeA1DxZ/E3bnlItQr+EhlA88vRJVqgAmZRANCcsU7lF1AfQJ3J5kwt0I+GAKhYoPoNG2iDnK6vAKgzUUedFqBqhw+ggoDWiY+neDlX3gNQZxJ1Wgu0TwKACu/iI4qwHoDml+BmWqBL1wGo+JMkv56WaN6ZLdcfaNRrXXg5AC1kG9QvNy1A47MAVDjQtEiyxP5Oj72B5v9a+0W/lq0BtJA9T19pge75HkCFA12cFWaSo77RqvmzZqAVWkjS2EoAWnDGUyct0Hn1AFQ40Mjcj8rWNwM9bB5chconpb7du3fPTNfLCTDpRUTnJaQZH4OQZvQhLqx7iDopH8rgq9dn/FaiW6OJyUdIMwG+YnZxUf/iPnnMdvqdf55AO4VL0vNV5BP9lJSUXrFeckwmLyER00yIoeS35iqtVxYNIV5eKfFM9o1la0TsYzHNFBmOYWVuoOu/6FI31pwcQNusNh9Bn0MXX3BW0MfaLl69vx5dvLguPsiWHEArLJKkfhiDFpLGdFUL9IUxACr+MpOUZxdfpkbDcgNqAWjBiaW1WqD3jgGocKA+tuQAKg3t3TnaCKAFZyaN0gJdeQpAhQMlynkdNHcANJ9MoxgtUAHz0ABozswwZ9PEjT8BqBP5J9XRAh25GUAf0xj0VpAOQIufUuSrBXrtFQB9TEAbBZcG0OJHLbBsBfphVQAVDrSRnPRlcejincg31SQt0HfbAuhjOkmaOhNAnYj9kGkBupqMACoaqLclhQy1ADTvVBrmAPSm2uMDqLgxqDG2b5PWRgB1Ji27OQBVJ6UBUHFADRHVFicFLTQBqBOxX5m3AN1BJgAVDbTp7huSFPPSEQB1IglnHYD60+cAKhroG5b7mMYOAlAnUmW3A9CttB1AHxPQNwDUiajlQa1A36cZACq+i4+Ru/jjbIGWecbIFuiyeQ5A36YXAVT4SdLCaklJQREGtkC30kS2QPfMdQB6h/YDqGigkrH1wYPJjC8zjaQpbIGOaOoAdBWlA6hwoEVIiQLdE1kxlCtQtfqiFaiAmbwANMcWhNeVpPPzhwfyBTrpOD3kCvTMZQeg5+kwgAoFmnqsapp5GFr95SS2Y1BjZHbHfVyBbmzhAPQG/QNAhQLtfMZ6w+2nG3/hCjSEJo5ZxxXon6c7AE2lNAAVCnRWuG2h2SmuQA/Rrb2juQJ9vYsDUK98LjgAqLNAByrPbdYayBVoMm26+DVXoPZpPSxAAykaQIUC7bPAtrD6S65AL5DhdCRToGVogQNQzc8AKgToosVWc3XGDeEKNDHI+B4F8gSqp8kOQKVq3wCoUKB+x2YdXJW6qtkXSTquQEdultZTA55ADbTDEejARwAqFKjkUakqEUUtKfiW+pIEmrBFiqUVPIHG0DRHoK5PlASgOWP8NLlnuULWK0mgl05Ka/P8goYB0FE00xHooEwAFQ20KClJoKP/JPWgN3kCXUuxjkBn/RdAnzagSb0lvzynuWYAtCyVdQR6aiWAPm1AO5qHdVGPeAL92H7/pxXolnsA+pQBNcoTvQwayRNoXQpzBBpRA0CfMqCWS433L/MEai9uZwM6PwtAnzKgc+QTpKVVeAK1F7ezAbXfYQ+g/wdAjfeuuww0TL6ScyCFJ1BNoQYr0AcZ7gY0poIbA91Pk1wGWplmS1LzKzyB9iVPR6DVf3MzoH5nx7kx0J0UVN5VoK3lKvBrzvIEai9uZwO6N97NgN4i6um+QKOJQl0FulOuhXBiEk+gmnqgVqDrFroZ0OlRweHuC7QV0duuAn0olzu61p4nUHtxOxvQ61vcDOjoZQvruS/QJR3yfNytWED7yhUNE6sZWQK9OC4H0F733Qvo9uAFH0SWdlug6/rQbVeBZr9lfulP3iyBaqadsQJ1fZoPXkAfBc2ZLZ+luinQBxmR2a4CHSD3ommUyhKo5uTNCtT1aT54AY27JJWOfOS2QJceGTbAVaB/OCpp58viBVQzN6cV6L5tbgU0hkpJ0q8Zbgs0ruvRE64CTZBPO9KpAkugmsueVqCtXnYroNEVG5j7sNfLswfav5+HHJ8Qj2Jl3IldtfN4OzCgGG2cG2F+uUp1c/9GZ/AQEi/nVz2ZoS56G/Tm1+ygEtwabUy+IlqZt9zbw2MnVXb5QxX1L64f7CTQsp5ydCGexUrHSiN+zuPtmr7FaCPjR/PLKLqb+zeBhpqeIuLj/Krzm6uLpQ0e5tcm5FFyW6ONSS+gEV3b4X6enqF0wdWGAor6qfyGPNEuPijx1f9xd+dhURxZAMD7EZkZRU5thAEiRkS8iMZ4gagBo6ARibqyGk9I8NaN0Sh4oq6CUT9vjfdBNOpqcM26xiu6MatZ8F4Fr2g8MFk03qBRs6FPqrtr157p+E119R/TTcn04PBjurqq3nuNjF7in5xnFMFpRF3i10aqLvHR4E/RJb46NOSu7h1vUNoH9YawN3YYBZrFGfDALaknAGjvJBXQXyGEIqD9YSsHNOEbSoG+Dntj040CHdaDe2w7mUigSAiSANQX5lMEtDSfX26Xl04p0BzY+cd/GwUqxEkm3yAS6MzZKqA7IYceoB7JA3ig2IlmGoBugne37DEKtHsb7nHqKiKB1pilAuoHg+gBOh2a8UDvGu63EAp0HlTP7mgQqKe9Obfb34lIoMGZKqCLsCkmTAr0eTLLA+0DPnQCbQg1seV/HQFaGYq43dehJAItuwtUAfUx/LskCOiYhULIh1fwbTqB+sLWpeBpDGg32MbtDtQhESiaDlQA+jYsogaorWOKGJP0uJROoHehCnYZkiNA50BDbjf6MIlAxb8eBOgcmE4N0M7wjgj02Fo6gYaB916wGgMaICz2yhhDIlC0ZoIAdDf8hRqg26CmCPRsRDUqgUbZbZ/gEic6AlSs3YYLSnI9UCQ1kwh0PjaLlDmBZiyQwo4bQlMqgV6IQFNvOAc0TojZGrCARKDXoZkKaEV8xRxTAu0yUAI6FjfTTAHQoe3R5EXOAX0HJnE73EJg1wNFS3MKQP2hPy1A3WtFyYkbaiRSCbRMFfoZ4xTQ/sB/c9dUEoGi1wcBqPEk9cQA3c0l5xWBPk6iEujxfGY7vGUM6AY7n1wXCUAnCCiSmkkEygQNpgXoKPhMBvrLaCqBJvVm/gBxxoCKS9SnQQUCgSKpmSSgNdrQAvQuF+8tAo3NohJoSRazFXyNAZ09k9/hhqtcDxRJzSQBTb5BC9BE7qNBBNpvGZVAW4zAl15zBGjgSn63D5OixPVA70A1NdA9W2gBmvS4HOhSuzuNQK+cVMxWOwX05lF+Vx8zEud6oIODGDXQBQNpARp+ohwovg6Q6YFufCbkRzYCVAzsbQY+BAJNTNUAxS27MifQnpHlQPtAdRqBHrjCMI3PGgM6+gS/w40GuB6o2EFGgRrOAU4M0K9SyoE2gZ00Ah2Tgb9pcAToiR/4HW6O2/VAY3I1QK+dpwSoG18XVwTqD9NoBMrFPH65whjQES343evwE4FA0VRhItBe4ZQADeATE0opwOO70gj01AOGGTbAGNC/pYl/wtEEAk07pwH6wwlKgE7gw/8koIUNaAS6suzVjpYaAyoCx91suR7osQQN0DNLKAGaXcOGAC1+RiNQbkxwdZ62PW6s/nP89U/CHglPIwfolZMaoJFrKQFal588koCWnqIRaPK3DLOjpbb7bZ+t/xxS52d4PwKBFq/RAE3qTQnQMfdQoF270wiU+9RbvEbTvB1q6z9HrX+I3YWBBALte08D9Hg+JUCH9EOBTkFWHdADtN2nDLPwgKZ5JwSxek8hz0QdvUkg0KxIDdCDH9ABNESIppWAfoZblWZ2oCwcwQYTHQFcoNL/eJ/he+Eg4RiBQJ+u1wDFJgIwIdAAGIcC9QjKpA8o/+lXol2o1Qr0h7j8CJeEA3HAniyg6CCvCBSbCMCEQPcJOXzkUoin0ugDWhl2MczVQu3gTCqM1HuOR+AnHGDijl0PtEOBBig2EYAJgS4NrqcAyi8doQxoa5jAMM/natpPP9Efg/VPuC8cYEq4uR4o18lWAcUmAjAh0C1CX1oG+qA3fUDfhIfK9RTi9riT/g7Nu1JYGiaPo8uB1oPbGqB79feviQYqplyUgWan0geUD/dI1P7H4guGH9R7jkPQRDho8HfygCpWY4tA0TAlMwM93EgJdAZ4UQf0O6jPMJ8GqZstEP30qt5zTIDWwoG4sp4ooJ25uEcVUGzBHBMCFUfQZKB+8Ig6oD9zIxVIwWpx+xji0kP1nkPu0mEC410OVJGISQQ6CpcIwIRAc58rgX4M+6gD2gyuM0wRqH+26zDvpO4o1qhgEeHQ9uQBrY4WCRSBYhMBmBDo+7OUQD0bz6IOKJ/M9SfNHNlI2DT6tN5zyPWuL0SQB3QUmq1WBIqmazIxUH9xBk8GymQdow4onw5be9NwCXbrT+cnzxxusNuIAxoHFzVA0YR3JgbamRuBUQDN60kdUL6ggJj8C9mmQNUHw/SeQ04aFgbexAFVlLgVgb4p/mZNDlSc6USAftG2Hm1At0E37oKunta8Ax6XZ+o9h7xmfQpUJA5oETr0IgKVFw+YG+h0sRhEOdBbRrLvvxSgq8LDw98zApQfs56nCVg9G8FmR+g9h7zWxBe2EgdUMa0pAq1kNL0dGUB3QRUVUCs3cU0U0FA3d3dPI0Bf4RLTBUAfVfPsZWwm6L1chPcSD+QRe4KAnkX/zkSg/BIu8wNt05hRAWWWbSELqHeo0Uv8f8CDYZpqFoYErmRn6F7+enKhfO/flDigN5K1QJmPvqABaGC+Bui1OmQB3R26vkUBB5L18vIKq27jtkoVbQ5sUXbWZrsIcarmtHOeEyFH5zlW54kHfeC6+t+8razt99i8nH1iTC7yRTVrPX7fscBFP41yq+pv6OkZI4S9v7vc1KnQ+dNVdtP5jdX0A52TGOI5mRucHZuenv75SKvj27dtyx7ehiJVc53V1ocwTuc5CmPFg7dgp5W0reQppnFmoJWCre8aTVN2u/kv/3UnrXfok7kmV+bW28/P70IzD27zCvFwYBuaWvbQDe6qmhf38r4F43SeI3egeLAJDqn/rZLV2+P32Ko4+8TQtcgXFaz+/H7uQBf9NMqtqpuhpxeWCnsvf7lpH6xz+nQVK+v8Rv8B+nHWZJgmoUb6oK8OYbgMKkWq5h0tWR/dES5DUsQDeWk9QX3Q89cwfVCkQreJ+6Adhmr6oK8hRaFI6IP+ObI1m9ncCFC+kKxizSS/Ld/MNtWdi0rOPYYZX3Q50I3PMECzSigAWkGKVUSAst0TiQLK+KbVHexvBOiqqdyjJiXIqQZsDrfWXtfPaz+ifssIAqqI+ZeAchnTTMa9OKIAACAASURBVA+0iZSrDQHK9KxLFlDG6DDTer5WfOMLquapq9hJMEPfKdzgFemwViZxQBWpFiWgmOg+8wGVp1dQoN8kmBfoumhMY6f9fG+mQNU8czbrZW+u73XHwkTpMDWROKCPr2KA4qqKmg7oh9K8HQo05SvzAr2MS1cQyYe1aHLW1JjFWt7/r77XRYqEfHCQOKB7VmCA4qqKmg5oVK1qWqBTnA+3cjnQ4x0wjUL27twYZastOIq1DHlV3+uuK69uvTKQOKCK+msS0M97UgD0+XhGC/Q++JgWaA/c6o+W/LLkpz3UN4jTWIsYUKCjLxQgHe4vJQ0oa9+AASr0vE0O9MwIDNDWzlfsdDnQJDvGymh+oYc6QagVvmctegcLkVqDX4eSBtRLMcQrAV3xJQVAl9zDAGXis00LtBRTCE5MbKeuKtAZPmEttTfre92H5eVPDtQhDWg3xci1BLSgAwVA5x7HAT1XYlqgkTC0vWbk6AC/EmmJalxwEExnLZisodgNWaYsL7wjBqiclkcB1GhyJhKA2uSUKQqga4pNCzQPGoOm79X3DPd48oqyNQDmsZaNOjNK3y5fOKrNre1qoD6KmwYJ6B1wNz1QqzxtpwAqFlUzI9AMgOX21qrG1fx1vLiRsnUc/MxaFLPY/2dDSrmV9HQOqNfYl0VCmctAAroLKpseaFMu5YYWaMoQ0wJtCZCJptkQuixpuEtz2X0Pa8FkWsJuXePlQ+3dsS6gi7oEzXlJJJT1ASWgH/LVMcwN9BZ8hwP6nt3DrEDrAAzqrp4yEm7V3zitue9hLUmF+l4XyVd8ebwzQAOCurSbrIdEjuNviiJmTgb6LzQW2aRAp0AIDuglTEVfkwBtBOC9/IyqUairqp5Z+RVCWEtMF32vi2RkUsRX6Aa6earHk8UvJnGxr93X4TclKpjFADWa+4YEoJPb2nBAr0u5MM0HtBhSmVh1F7pLK+4xVlUxIQy8WYtWG37rVJ7Trk13J4CyywKZWRGVXkgiEOwJ/o6+KdnxDAZodU2UoPmAxshXKwXQHKfzM7kc6C8wVZtBcjhfbab0qPpzx8ZaLuiMO85bLh9mBjsB9BEcKuvxR7+QRP7NuI9edfRNaTUeB3SQYvDJnEBjs7BA3ZwOqXY50B1Qu6xLVkXZ2J7vlKL1LMVPQtaiN1E20oHlY0QdBToRfiy7Tct/EQk3exhTd7yjw0MNTuGAGk0tQgLQRoexQJmIs2YFOgaKmfqwXdkoLFlSFw5KWVYGtEhnOtRnG+XDu2r/eoDeiLdxOUZfewGJ+2WdqwB7tINvSosROKCKrLYmBZqQgQc6vpVZga6GFlzeT2Vj0GDuUT03HZP7G3VnHhbFecfxeRFlrRBNYfVxWRWiRhHFi0Q0oqYiqHg9qCCi0aZiHqMiiUcq0TaJd7xQ8D6I9YhGrRqlGKlXxPuqYoxHPR6aajVGazQ2nu28O8e+v5n3nX1nlxTm/YPdGWbf2X33s++88zu+PxFQXlsM4XHSv4QD0OuYoc3ovJ9Q7Y4BEvUc4gDmmS2k3fx7GqAVUZrlAc1JpQPaP8qqgK5CqwV/B8w+kjU2xBkTtJILIqAdOW0xy9w+e720CAeghS5DQg4K6xvvjGYjEYt/RE2emhyUx5dogApxH1ke0MQRdED/9qpVAT2JDpIfy9XkInG9NZWtoqaLgI7hVKIqcFeB1kuLeAZ0l5T7FIUabk+Jf5eNRARe6qY5N5kblIvrqYB+ddDqgEY6FtMBzepiVUAH7hHpWQFzml+S1KYut4SHfrNIBJTXFnPitPr0R3TINKAdpWi9mScWoWt5WWwkCnCdxeizK8z59k/UpAKaFGt1QOe7E20goO12WBXQp5jNZWFgX1N0i2YeGntYBPQnTlsMkS9CBNdzA/qDQ/6a/B70CWN6V1+q2nCLtIioZmpQUmpTAfUxMb4cAEoMNQR0nbOiRQGdtFL8sxCGKMnhkvcQ+IzC4bEioBQZBmojMuXqomamAR1MrH9HdGYi0VGK249MNKffRpbxIgDljXUtv4BORXPogF5BaywK6IRr4p9TeWDfGkmd4Q0EXTSLvhEBDeDMHlCKcQs40PmKaUAbEVLjt7CcLh2J1EKpo6wEM15KfzSZCmhxizIA1L5zWOkBSlj0IKB3vRXgL3NA0/GlODUH7JOLtGjtl9MfiYBWR1xGxyrotnbFYArQfUSO+vzQr1lIfCBrPLZPLzExJr9H3aiAeh/W6z2glS6gRqUH6JbRNjqglb0VsS1zQFP+Kf45CJMdNqAx+EEtxSW3CyUioDaQb8ZspNG7kk7swTOgI/sRGwPOsM6SrOTarN9qoip6XTSXCiilqugvDuiW0DMnbKUGaDt3KA8EVAifYVFAE/Ebj3GATyPXgZ2JoAFya6wIqMCXGE9m/QShxWYBtceRYrKzuzIOr4OKlLc8RK/jzGyHoCVCBfRR//8/oGdbTNRMob4A2mg8C9Cz3S0KaDLm7a9QN1lOGdaW+Vj6NgaULzF+HDlJ6aSLPQLax20uEbDKPWOFf8tN5XfoPe4xaQwNsyqgqSNNDOyWpJOVfQY0chaaaV8e2rO0AP3+MxagC59ZFFCX92QuArHrb0q++TuaIo/hszCgW7mMhcC0lDDCLKDzcKk7N64OhiDUjNFq5IotYTb3mDyEFaBUQDPT+ce1b9znXQtsvgJ6GQ2wCU0dt0sL0JNDWYDe3GNRQJ0fu6YfcM2Tc9oXaJxG4o25COgFrtuRt8gSITuWmwX0Klz+7mVELv+GiEp68oR7TG7A5CMV0B4mClc/Gu43UXOFMQ+oPfsSjpw+eaq0AFVFWXWAeluUu6wBtbvWh32h6ucmKYioFZjGXHqhIqCruMIOwOyrlSjxDOiSOHDAjOQa1MOKCQ/zx/Xn8bqT1jnsVEDV8qKe22vxPYRX0Ms+AtpYqlOxMuFXpQNoFUcaC9Cr3NUvyhegkjmoMvo3uVMOP7or1yyTWzDaiQEddIDntLvJQLmLQ80CqkljmspIxjj3wP28/VZ0j3NMesPZRAVULdDMY8/xE2xd9/sI6LWlrl9KXUeF0gH0FcLirAG0lZdJH2UNqFS9yg4lPK+iEPxwVE1hdbX54m2ICOiA5jynBZVoR7U2C2gj6N0MdtSj3+H1Jjb8Fo7scEuIjJ5ZzSMXE+iAdkN/5B3W9Tij5X6OzTdA98n3NP0XPf+wYIoW0H9ldjDZ31tE1IMG0AD0wpKABkpzJ3ROV5AKcfeFYaKvoSIMaO4+ntOCyehJhFlAF34Ot1f0ox0VDFX064SixAEZCGV7SrEl8qUAoPrqpMy2qIXr+LU+AWrvLA/7RoTSUXcNoDV2ONBn5oJg3iOK+mkAFTqPsCSgsufyKaghIudoRMN8eVzYSwT0FFfgVgy5zNNp33gEdLpmoRvxmHbUNjjFC7/uHX74+LS30Qq7ce8aqRMV0AX8RS1TBusndtOAblPMuJWmDUGjk2wQ0N3o/cnA2ua5takfxAR01ReWBHSzZD7MC4N0ucaqPdSjx+Z7EdCb+TynPU+G6uk8NB4BLdQEf9ROpB1VhMZR9vo/1kVPGc/PKqBr0RTuxZ6LnJwmPgFaz6EksQtZaLbyrkOarXKZMDYuFYRlT0x1uLxQYAJ6/wNLAvojaqX/ymQVrUDov8XziwjoOzk8pwXZyVGrTAJao76mfsM0XDxU1444qRfzoIRM4zfXpTUd0HHQBWp4LXXdA7bO9wXQqvkX3Vf7OkGFl465RmV+oVReJfcfGOHXzfR4vAEb0MxPLQnoTkmJIgtkkc0Kl6YiGPSDraMioJlf8pz2+VZio+SCSUD7aAw4tIK0YostpL/8sIegj4EP6IBu5vZG9ZNM+pMdTX0AtJ4DmPGeI+lT30OFruli4H9EhjOGmunxyVg2oNN0qYuWAHSwpCrVC2QYH5Q09zXlf7Hipwho7848p31AJvbGbjUJaCtpXieXF7Q4/ktdWNYb4zf35UY6oH68JUyqJ7oypoSe9Uf4AOgZGAPTZ0T/bPEmvNL4LktCOwUJ/vE4hmt/sp+JHslfnhbQQ54WPuUT0Ky9Eqdg/t8vT5IwGQgbn0RACdk6o4vNMnIFOdwkoC9rwlSwdi7lsAb3WRdg47vxIR3ogNqcX/MN6lzl9v1mhveA2rpqnbPbLqb7C03iroYkoILIZi5fXCd0zESXpJCyFlD/+jFWBPSZFEPwUTy42GRLj8ngi8TxyyKgehkGWrtOzg7/bWkSULVUhfoCdJtyWMZK+svbOwx1NCI16cUqoEJXzqy5dil25ZfU11tAaxQhnajUMGfMmsQSf2FMCfph33B8DnuCiVwBcAXQAipc6G5FQAfdlxco5PtIldN4YZYjthyJgL5Q9dOMGjDnxzjs5gCN1aV4JX5LuclwsNI9C44b9d5eE0DtBjR7Jd+gbldcrPMdN7wFNAbF69Op2y79XdJdbGYajxIlNaWIPP4uh0mB5gxAvYtnKmtAZS/kTCw0o7YmsiEbFjg631DAgD5E0RynXUQK5lVAfuYAbauLHD5HCVH5O9NKuHJ4EO/3CADN57wlGa5Oa/ltvQU06meKc7xu8sBaLjto0y2yyT3Nye3dIsRBaYCuzy+XgE5eEIhbrZBAapvUy/XQEX1I7AzLlx6TVpOHLv8K9xP4EB0K9Nz2HCc2dqI58L+VA4xfPf2Ads+g5vqjdoM3TbZNaKpB73PRGLAdHBAsPxsVEcjTxqHbytNryZXV3bUCzbSL92l73+8UGFCZ3HEUpXF3eQ/1JMY4WPNf1/dnuoXwfqpaqb/IDLpUis+CPplTstEJRiHhdAJxBp3iLoBk0Ea+ozFQmZpBU3Sxna336o+6AcM6yf5bGpX31aq5umfQ5gM475E2KE9nol3ezaDVdVHcStMEi5wN4+6zNpm5o5tBbzv8y+MM6gHQhpdlCyB5tVSU6faAZTUWuxMB1cQ4MVp6JrExjwwO5QDUT5+Y95yim9sjnInEGaP11m81Vn83oKf2co1pbIq6pj5KLBdMAfpnN+TGgNYcHsTb5xfTjQAt4o80KD+AKje0VUFteCW7cTzwiD+a7gKUz90CCshu0Oa8egC0rv4US+L1/vV+T5lIpBrpNl4eLTAA5dQ3H+82b1UhjDemAD3OTC/RADoGSemAw1KKPPX5+LoRoNvQHesBGqIEYQ2ZRexV6lLDMDkcYiECuhlxSG7bnGT83hq0yRSgC9Bd7a5blEi4FtuZSLwbWoPd/fJCFqAbubxkVeII68HPEV4BWjEhlhPQoIz19sa9+jRdgTwmrk5YaQSoViLOEoDuUqShgX6kbHsSikHRrlcPuwANhsHNjBUWuEjrxB48APoHpCtAo/Mt4d9P1kvsZaZBjufQkyxA9WLltPYd6ZNZ7F7QmgF0E+Xz0AEVmqCcT1GjsZ3bZOQZy9cEAPOvDlBhR6z1AN0gXz+ggUWRThwANPtwVKcIaEWewHWo1VBVa2b3AOg6p27ZFUARl80+zURim5GC1PViFqCLUQ2OIU1zViJtVse8ATSCXbhWC2j05Ty0AjWcKFxxhnmA/idDQLfnWg9Q9falmFy+5N+U50xwU4sv+CKgyn2VYdsFL+pQC8kjoIMpgTd6J09Q3BImElXjlrC7L85lAfoJlxOihFw+Roa28QLQOc4j3ICK64EKIXew0bSNY61Rp1A+QA9oVL71AJ2rRFTmkq7Jc6vh3bzUsE0fA8qTGP86DCVOOGgK0KGUkRyvcw6tQVfYSDQwyJyC6qAkoJu4JLa2gwQBtwaKCUAnG4QWsXOSIncYeshagDhsPaDfhlsP0G7Kai+KFNXIlmvCQyl3bBXFgE46zbNMA0ssbS69B0CfUbKMD4zS7mmGjrKRWJ3EPkPScxagfOq8rmh6teXmeQFozQmCF4AKpw0T9wuGGgP6ArW3HKBvKKlDpycRexVtTxhojLPbMaDaMvK09iYsy1DQxBSge27q9+3XhdAdcVZhI/EXA3dCeA8WoH+SRKn+R925x0VVpnH8fVvRUQRLodEBSZNJLl5CZItNzVAYZBQNL+t1aQWDSI0kRVG8hCbgXUxdRNNcU9eoVtxWYr1lLpkiqIGKl8TWjxbmWq5u2/bZz855z5lz3tu5zIiTvn/BzOg5nPme9zzv8z7P76cXXxPh8HOWoa4DOr7RLUAHa5lKmAm5IA6gP6gvzB5YQD+1SqRMxjchEqTKjNtEc5mgDyIAyvRocvmIosNXFwDl9XctZpxe0/M0kPBOURUaCadXeQqgTD6MNxaRcgGr5XZJ44Caivu5BeiTzv2Uo5zqw21kiQELaE93FO5+YUBlLglzQOcyKJ3o7hBuUAHQyun6R6UaeOlWZW1AW8NfsS/OpnejwNpGLSRCN6i9M49stcIB7WjEiOb31K0yqa/LgM7ApNVcARSUS8+2NSnhzHsZcc21AQUVmx46QGXnzVtQ+YDJIi1Mif5xszDxCICuOal/VKqHqM/XrgBKN2uiUUpqejrG8TFaSKwPVLuyjIi5AqiZ0eHjjGPUruvaSpcB3QtnugdomWNyMIXG16eIkiRk9ozcp+UAuv3gQweos7COWL/K1cGEDw1K0AuAHtugf1SqAvRuviuAPg05Ntz+WVR2q1ng51pIvM3MuMo7N9UApWvtuSGolfpMYkhLVwEdnQfcAzRtjslB9+HizgmsUMCkaj1Ag+K9HjZAowfJT1Alxebr1ENIxNuPkFGgAOiwCaoH8/pQEg2vI2vo6U5QbUD3MuEmSiJQFaGxjnlWA4l58JLKO4zxIwbobv369RW0qc5Qp/aecUAP1LsJ6AD4/mW4x+d61NZi+gpGUdWxHEBX8R5NDzagT1XKj1XlmSH3w0vtx+JAVqsCoP2SNEJP6RFJdSEtK3YF0LpI3qs1VBybC0s1kbBfVXkjqByoAkr1e/LG0kj6m99d4iKgvQdmuAmo+aOBAYeE8OADrMxPHHOJmnMuoD6FVx42QGXbgN5Y2C6bHkgCDuJAjZUCoJMTVA/WB0oKIFQfJ22RrA1oNfcB+DKpVwOOxGsj8dMWlWN02qAO6Gs5uhe0D9ODkVzvIqCZ8S3dBBQsT4mQposBdB6Ouu84gIIxxkv3HhBAZ8VIPzTH/Jrlgrpg2Eb56AtCAaMAqEZb59mBWeLqkgoDvoPhLgAaze0mrgshL+7hd7SRWKKWCc0+rA7oz7p9O6ZCZinsdCQxDOi6BuAuoCBWbLgxM7aNESf1AR1ASRI/+IDK1lWmgAxsFf0iJxhEyygBUNqdBl/IREjyamFdiTcuwRYuAMpojaGxj6q3rdiqjUQ7y0L+G8WH1AHN0dWH2QmZssyCFLNLgHpre2Mbk1/Mp2+zpHR9QEsZv5UHHdA8eTrA9O3kfUoim4l07AVA1UUKh8K9VrEIooFMaFB5ex1AN27lvdqFFNmdIZSlaiJxnB9wtWbUGTBASSN53jiTytyes6W1h1FA32KsId0AtCSBBNCPTh7zAAWv9rsXQH/4o8cBVQwLNyo34IvOboSLeNwdDJuJgH7BlewSxjQYu18swifthJmeD01Ava1coxszWaD0gbDrp4nEZf5s+ATTsoIBWlKhdz0HsY9nf2lfyCigYyb53zug3SjKu9HJMy6gPcp97wHQvw7xOKDxsgIspuz9hdNxewWOYoYViICqd829lBIeI2r1U6YndKOvJqB3GOdEKcAlNvT/EOejg0T/SG7W7xLzAMAA7Z+qF4J25jToS60WRr/7/2gb2hkDtDXpvADSy80GAF3uop4jCejUMI8DqhRqnlSKJB9zyqASJR8FdgnQnaquen+pBb+xIt0RomdOSEp+YxzQJSo1b08RUoRpx/WQmAYf5b3cl6kIwgAdB8O1L+dQ3jccNtYlQCu+agJAQRGREetpozP3XEDBytv3AOjAaE8DalbqJjDhZHnbU7TqaCbWRpTskQCV20SY2SWrDrQVwwOysAZ4UVuImoBmxPFzIdVE/rXhpB4SzSZt5mbWIjQAzdUTAX8acvQQr9pdAbSV5dumAPTYhP7D/eTfau2lhgANO+U+oI/APp4G9BElso5RSutk9SVR0HWIBXUUCV3HCFA/NbXzmY55cgRK8j8CKXGklOHGAU1T2QccZ8GXJ1V3dZEItnB2O80pRzQAJZ4ZzTlf8bFCzot7RU1/g4DGcvbR3QB0LoQhzu5S8xuQEfHnAzousJ3bgD4JGzwNKFbYk75RfvVTq/QDclFoaQ1EnR9/6ioB6kVpb8lDMJIw2YMA6TYhPlk2GQc09LTasgCz+jAj3QNtJJrbQlhzkN+xAQoGKO4b0d7WwEynPiG8doKb4r8yCGhQSLumAPTxHYl1cSMbn804Ctp1DTjlYwzQnYY1ellAt8HtngYUax3C9ocSna0ByEVhLsyJF/56VMQkAArU0niDhdj15Fr0p1Ar5bE9jAOarxKK98blZY+iC62DRM+kHcxrS1O9NQDF+0+7Z0Ebna8YyQ1vvCL7Gwd0Xvld0BSACmebZYOOcXFlYBkbePAB9UlNdBvQG7DG04DeUXr5MT/ZZYUyEv9yTK1zxPII1CyPAC1WqQU+n+UPwKEEfyHTR+1YHAw1DqhNpefJhPfu5yIPeT0kerH2xRzRWwxQf8z5+/i12EC6+u5jfootO9Q4oImRM5sKUHAoNPhm1KypdFe3BqDadSqqgPqM7jRx8XRYuNDDgLaHq5Tsiyy2tskZBPoJFUGhp8Wp60AnJ6BTVGSiRk9B+cnrHFszykZBABT1Ka5e0+sGJXOj7mx+DptaN001gsQutj30yyFagGLph1877k7mw+ezuF97UIq3YUDL9EzpXTXyat/Z7m0c0O5FrgPaZlMNFEeZhwFdpBTZYUWYt50b6W2E0Ds/zIT8slChDwJ0lsozOKIGBaKPCvX5VEg0+kca0BuBtY5QYENAPKSqP/+u3DTUqMXKNMTtbD0kWF32xwPXawLq1Afwef1sSCtQv5FqM8vZwj3OP1ANtCFAl1jGNTGgoON1YBzQNw2pZ5KAPmd59eeQr+F/w+ABDwPaFr6icCGrwMfINm9WxwOvfCLIF4QckPYIAvRgKP9QVTvQ+sgRpU38LfXWERsJ6CfdkmyBGYPPwca2tyPJR3quarX5kXg5MMi1LDAC6B3LRCqWeBe+oAlohFR/GAw33nKEKikNpIBeUXfucfzLdxkFNDvbv6kBVVlE8QEt1RCGaWbmA1qTDEwd/w2rrsGxHgYUc9SMUra6v5dds+KHI6W5eqHh2l7gBPSySs9HyhkgqYiQngyO8U8LvqsTtbcKll8Is0DY910ArtmJjfrEUWrx6WDFR63HBH9DUV8t3SjyOmcCwQFNE1XHSveMR/93GCRuRj81bfE1B/TPJuqdkaB1JmmO53lAwRxVkPbFbQZPXGcBFTMzY+CGYfCshwHNVTqlMVtBRSVzdyaqvRO0D03IzhMB2oP/nBshbhclTHYgvg7QXKzGfkuH8NkujvktOkm4iM+vJBaHMap36U0lQ7RODPX156wfT9CLeJMmoO9Z0VZSSbz4RT2zJQ6/e1aQ3dTKWBDgq3s2OXDKtteYKd3jgDaqaaD6J0WmXrSX7WQAHYkcLPrB5DSY52FAsd42U9x8549KuduUNLAKtndcfrNUMIoATefH2e+LwaTgJ3+Qzui+QdgVn04qQROgTzvp28WL8bK/V81rKs6DUsmcPqD97KSBcf05oAnoAFFr90sn1y2TKrFPFnRWKfiNFYrwtM/mE2t00UfW+frf2H0GtHoP58VnSoFXNTwjrIPmvEcDegkJBS+DNX3hbg8DugAzSD8ulzN1lQVWzr0MljjOTliZr0ZLeQQo4yojjjOdEXVlvTha768QnZS2XUSa6Tqx90fqdhBjt7NY7HkpkNIHdAbxUDYVWOu0AV2N9tbmKZmEW3jVUEOy2uwTf0TvbIJSfY9WqdiKexLQxdCP/Wyq7UJVwJDw6o+/hdB6gQK0AfUyDIcRmdDmYUDPYN0bZZdZVLNzUFW9UKG2HNUYIUBJzxp5RIuL7MPrUGhADl9873MGzCXzoMldlTzJTI3W9NObpR/+JtWTGFiW5OP7x9/AK97agIJTwt35meJGYJ6KrYvmpKkdJvmy3tlMOAxAlw6mXxzQWE6x2GfQmheARFV8pn1ol3WKvBGgHSCa9ufDXldhqocBxVuHlFYdxQ6qcjpITBHyoW+K6SMR0IX8kvpBYj9PWpEjXGCawuzYDvhCywgS0Lewcv65Gsqeh+zSEzZGEi80AOhXNgXJRUX7uZcWB3SrUBE6eZTyKB8zVT7XeerSHFfyTNpn09Ooi939BtQcyXYTHkt6CQ5z/nIXolvSt6IysqcD0D9bxM9/Dk8Mh4EeBnQI9oVlOk3TMGmY0J9AB2GP3j5ZKlNGgD6GdnGYUSjGhUtHgZbsLFiFPfTH76d3krIVsZL0Pep/SzdJdMZUMdowoLFKPUyL0zBTF9AlQuZtM5aQvqjMpvuUrBw9VsD/8c/m/AGz3r/1LKCgFtLiWi2yCsxz5Y8fbYCLTMHb1lugsNPdOsMqhgQL4Y46qFGNeF8AxVtwvrO0coZhcmrmxCDRHj4/Ruz4EAGdzSp0A8X5wLHw6sI+RbY3Yt/lJRrQTJv8h1f+v71zj2riyuP4vaHkUQmgIagJYCBAEVB2eVNQfCA+EBVD0aKya0GpzwVExRbfIkpX1/ejVhcpLWhbX6B9uiriaj2+VmvttpyV1e5y9rS7bX3Ug+3WnZnMJJk8J22SmbPn9/0jk0kmd37zm0/unXvnN79bb/tY/Er0dfvHTCwKl5FH43yJnfhMjENAfaPmIukkk4hNmVrTYTDTdgv944cHfL0HRHfdY3/cT0Xb2vdVqUAA7XE/+/CfV9aZJBJrU29h+WN1fCrev+T8lISsfsgnnh4VX4UntGEs8iyg9SZ5Docy2Jlknnl0GT0mO+QZ3WgX9mYA1VoNeWcGgYbjDpMbVIa62hiHGHldag5oP2OVBNGRaQAACYpJREFUu/pFOwezQ1+zfcPEjHEBdAITptUvaoD1SRxZgKLoidIU1jO9kfg4/f3pHXZGOffuuXiF6GEUs/CS31x9/I/ksRbN6EICARRlziF764sTfWn36erMsm09G1S9N4g4JTvx98hn2vfMSOHVCxjHeRbQbpMhnSom5CDP2NUk2nfqDufgY3SIEwWo9Sz1zDB6A660MhndekPy1N6h5yyDRc6H0gOyPexOeTpO/xSHhklwywXQ6So6a3LhpnzEAdCTODn6Q9OT229Y0DEqbag0Z4Od/fyLOOkL8W2ca3po3+HbJ8h7V8lBlxoEAyjqOHQsorV4dLX+IYqY4qAas5bq2vt5fQ7JUZKmTiphnm9+G5eFY5szU7kJUNZwEJOKo9x4iRkyST9JZi2WDao2ACpdYDKaF9ayUt8+6EL1Z0akWjM728I57zFR+hWPcYUloEnMZcVRs6eX2KqgxnyqQgc7AejHdEjh08Zc3XYB9VWnRZl1I76YRD1FpDWPcmV3Pspyx/oOFsebhBbFdiUUv6GcSFRBqRHcZ9V2P6DEPrbI1i7ILiDTHnz7DysJcejbsQ/wontMc9kLn/PCuMOzgLKSJZ+iq9M3jVMNf6MKpq4sU/DmrssGQFH1bVbFkUM1iIY7QMdu3/nBYk9DmdzFGfhIDyvhdtV0hNSzanvRvGI1eTurrCDTCUClc5qouOPtNtO3sgFFpfiv5oHKT7JIqy6ottjdE2WNdJohkbwiYgEZ4DCIuMB+aR0SFKDU/60XWRloMT5oMzpAErR+CHNCXsZPfsK27qQ5CWjy5IPhSi6AjjStKgbSXXqTyYJewV9Tk1j4qtZ83m0EdP8w4690BRdb6shT8xkT43R321TLyOskqh5TVl4trl9kLR60ubr30ZQklNz6G7tH9jtyppH5ucgJQNEjNUXH+pIYboDKtVasn4LQgfkOEqPqrYkrKSOq05BFUtSO76UryZjGVWjrBOEBipR1BFO7Ik7Y2SQ3tJsJYPoSr1yGbaYMdApQ+cARfoOHcgBUwnrY/4ss4pDk0586aAhmQv74lv4/c6Tv6AwjoBkmnf/m46gxa0fd9o2Gp0fu771kGTAaQz0/+hEOPU2Gp1gC6q/qTMAjO3ZsspvTAP12lIy4yG13ClDUk7yo/s8n5xE3QK1pW2sAuj8jkQug6Ec83bsM4/qP/jtJf5TXJs6yP4E9T4AiDVElLbQ73XcRxk/otwfwlFcwrnEFoH0GERVyCAdA81h/iDx8hzyZzdeMsyONx3tKqOOsv1GiMwJKxb0t1568e8gn4AZRp23DeN3kEpGht2QtQ/JicvhI84P+HFuJqN9N9DFUf7Kes8Go8VFnBtdli5wD1C9na1v8kVFevwDQtXhBz9WOUp/T1lTV58zEEVkYZ9M39BsL5tucmJNXQKcERb9kd9pd1HvMDKZbpMVe7dhO/kYnAL1I9AbCyDbFV6fTnakRk1IEiC21OyjTdLVM3dStzg4a02z4RKZSLabe9FXjB+RSJCNf/4avRE/NIYhKiBilXi8W78KDxuDvmB8lRuFZlvsqixp25WZBqX7FR2LxvUi3IutwHW4Q29fM0IjCFYa1YDEn5RKmFoyw+bVI4uuohLgEoojZDjZirMm/jr9aNCu7BC+jP4jEd0RizgrwEbtCCocHJS7Cr0ZkH7W7yctaGf3uIfY6iXG5zS19SjkDOjYcoUwN+V/UaDSllQpSwQEKSy1NY63md46+ey72WuFPxo/iC1Op5R/27xyvL4d86ThVWHg39/G1Id26pvNVCsU7bQFjp2oNP0r/3Mq+EjsL1z3TpC9EIZMorG2iWNqpcKCH9V2ZxrUABSc1rmxZVWHne4nMYRHf7u6urXKwjcGa4ecJZzz690ZmvWf/YAV3SZzZ2LaCHR9UwFcn9p1ztA1zVMtP+ye3FMXZ3pD7fPHDiXYybACXTpLTUopdUoyj+eK5ytclpXBo4j1ojQebeC5yR3a7Pq8RV7chACgAKlBA5dFJyhdiAVAAVKCAolnP56ZLAVAAVKiAmgoABUABUAAUAAVAAVAAFAAFQAFQABQABUABUAAUAAVAAVAAFAAFQAFQABQABUABUAAUAAVAAVAXA7rKn1RlrL8rlJLnkmJq1qa4pJyhLinl3trNArLGv9d2lxSzvcglxVRwPaqinwnoUS9KL0z2coVq011SzKfN4S4pZ41LSrnQ3CYga7y61rukmPRalxTT9zWuW8b+opp690IkILUvEQnImsYl/kJyzuJ/Csma5rc8sx8AFAAFQAFQAPRnd8aWC+moA/OVArKmd34PITnnHSH9eVFcMAKBQCCQkGWaToxH3ZuctiEOoX2RkZFT+DeKbQbP1pRHkvIRiG82eyNzx7jVIlY6Mf6UeVbrl3oOIY3I21vOv1EsM/i2Runt7d1nrkB8k382EJk5xr0WsdKJ8aehOoQS05CfRhBGsc0QgIvkVzOF4ZshGZGB5o5xr0WGdGL8yk+MUN4G9IHm9bRbMt6NYpshABedqEVC8U18IDJzjHstMqQT413bo2ehjeOC5St+z7tRbDP4d1HvXAUSim9IQNmOca9FrHRiPEp0q5SeXll7VhBGGc3g35q8W0gwviEBZTvGvRax0onxJ+8XqYw8Wi1CSRrejWKbwb+LQtqF4xsSULZj3GsRK50Yf6rU3zarGZipXJnKu1FsM3h3UY/+VcLxDQko2zFutsg0nRh/SieH+q4g1HNm9OxA/o1im8G3NQ2PrBjFJ6BmjhEGQiAQCAQCgUAgEAgEAoFAIBDIWfm9ta7k0gDyaRh1DacfyG1OmQwCuVxPXd6b+nX4Z5cDAVCQEBWyiXwiLC40HAAFCVDS0FRquexXBKDlTTl7xyLU8fe64pYGYv3Buwlby41L39wjo36dCICCPKhG/Ibhvbq1/GFzQgya9pfYirt7yPVlyTej/AzL0zcqv0y7rgBAQZ5TBa4yAjoOoQ9wmPRwI0LvzdGva/FzzDIlW0G07/PXAKAgz+k5ugaVdBBA9kJoOQ5DfkvPxI8kASWa/QASUP2yFqsJ4bkAKMhzUia8SS3779R3kghAxYXPfPq2FwloHg2ofnloBnSSQB7XvlYJeSlaMNcA6MksGUKrLAHVqh4ilH9qBAAK8qDE8yamVqRumve0AdDNeM34nptKJOaAos5PLsa2vCsHQEGelKj0esK8AWQ1SgOKdDPez9g4bY8FoIH3q8f0D4MmHgQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgf4/9T/x7YMGhnydGQAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># You can remove the baseline of multiple spectra in one go</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># Note that the same parameters will be used for all spectra</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>clean <span class="ot">&lt;-</span> <span class="fu">signal_correct</span>(spc)</span></code></pre></div>
</div>
<div id="peak-detection" class="section level3" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Peak detection</h3>
<p>Once you have a baseline-corrected spectrum, you can try to
automatically find peaks in the spectrum. A local maximum has to be the
highest one in the given window and has to be higher than <span class="math inline">\(k\)</span> times the noise to be recognized as
peak.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Detect peaks in a single file</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>peaks <span class="ot">&lt;-</span> <span class="fu">peaks_find</span>(corrected)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># Plot spectrum + peaks</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">plot</span>(corrected, peaks) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Peaks&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="energy-scale-calibration" class="section level3" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> Energy scale
calibration</h3>
<p>If you know the correspondence between several channels and the
energy scale, you can use these pairs of values to calibrate the
spectrum. A second order polynomial model is fitted on these energy
<em>vs</em> channel values, then used to predict the new energy scale of
the spectrum.</p>
<p>You can use the results of the peak detection and set the expected
energy values.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Set the energy values (in keV)</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">set_energy</span>(peaks) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">238</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">1461</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">2615</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>peaks</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; 3 peaks were detected.</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># Calibrate the spectrum using the peak positions</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>scaled <span class="ot">&lt;-</span> <span class="fu">energy_calibrate</span>(spc_tka, peaks)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co"># Plot the spectrum</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="fu">plot</span>(scaled, <span class="at">xaxis =</span> <span class="st">&quot;energy&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Calibrated spectrum&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Alternatively, you can do it by hand:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Create a list of channel-enegy pairs</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>calib_lines <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="at">channel =</span> <span class="fu">c</span>(<span class="dv">84</span>, <span class="dv">492</span>, <span class="dv">865</span>),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">energy =</span> <span class="fu">c</span>(<span class="dv">238</span>, <span class="dv">1461</span>, <span class="dv">2615</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co"># Calibrate the spectrum using these fixed lines</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>scaled2 <span class="ot">&lt;-</span> <span class="fu">energy_calibrate</span>(spc_tka, <span class="at">lines =</span> calib_lines)</span></code></pre></div>
</div>
</div>
<div id="use-the-pipe" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Use the pipe!</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Spectrum pre-processing and peak detection</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>pks <span class="ot">&lt;-</span> spc_tka <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">signal_slice</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">signal_stabilize</span>(<span class="at">f =</span> sqrt) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">signal_smooth</span>(<span class="at">method =</span> <span class="st">&quot;savitzky&quot;</span>, <span class="at">m =</span> <span class="dv">21</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">signal_correct</span>(<span class="at">method =</span> <span class="st">&quot;SNIP&quot;</span>, <span class="at">decreasing =</span> <span class="cn">TRUE</span>, <span class="at">n =</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="fu">peaks_find</span>()</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co"># Set the energy values (in keV)</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="fu">set_energy</span>(pks) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">238</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">1461</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">2615</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co"># Calibrate the energy scale</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>cal <span class="ot">&lt;-</span> <span class="fu">energy_calibrate</span>(spc_tka, pks)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co"># Plot spectrum</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="fu">plot</span>(cal, pks) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="estimate-the-gamma-dose-rate" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Estimate the gamma dose
rate</h1>
<p>To estimate the gamma dose rate, you can either use one of the
calibration curves distributed with this package or build your own.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Load one of the built-in curves</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">data</span>(BDX_LaBr_1) <span class="co"># IRAMAT-CRP2A (Bordeaux)</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">data</span>(AIX_NaI_1) <span class="co"># CEREGE (Aix-en-Provence)</span></span></code></pre></div>
<p>The construction of a calibration curve requires a set of reference
spectra for which the gamma dose rate is known and a background noise
measurement. First, each reference spectrum is integrated over a given
interval, then normalized to active time and corrected for background
noise. The dose rate is finally modelled by the integrated signal value
used as a linear predictor.</p>
<p>See <code>vignette(doserate)</code> for a reproducible example.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-morhac1997" class="csl-entry">
Morháč, Miroslav, Ján Kliman, Vladislav Matoušek, Martin Veselský, and
Ivan Turzo. 1997. <span>“Background <span>Elimination Methods</span> for
<span>Multidimensional Coincidence Γ</span>-<span>Ray
Spectra</span>.”</span> <em>Nuclear Instruments and Methods in Physics
Research Section A: Accelerators, Spectrometers, Detectors and
Associated Equipment</em> 401 (1): 113–32. <a href="https://doi.org/10.1016/S0168-9002(97)01023-1">https://doi.org/10.1016/S0168-9002(97)01023-1</a>.
</div>
<div id="ref-morhac2008" class="csl-entry">
Morháč, Miroslav, and Vladislav Matoušek. 2008. <span>“Peak
<span>Clipping Algorithms</span> for <span>Background Estimation</span>
in <span>Spectroscopic Data</span>.”</span> <em>Applied
Spectroscopy</em> 62 (1): 91–106. <a href="https://doi.org/10.1366/000370208783412762">https://doi.org/10.1366/000370208783412762</a>.
</div>
<div id="ref-ryan1988" class="csl-entry">
Ryan, C. G., E. Clayton, W. L. Griffin, S. H. Sie, and D. R. Cousens.
1988. <span>“<span>SNIP</span>, a
<span>Statistics</span>-<span>Sensitive Background Treatment</span> for
the <span>Quantitative Analysis</span> of <span>Pixe Spectra</span> in
<span>Geoscience Applications</span>.”</span> <em>Nuclear Instruments
and Methods in Physics Research Section B: Beam Interactions with
Materials and Atoms</em> 34 (3): 396–402. <a href="https://doi.org/10.1016/0168-583X(88)90063-8">https://doi.org/10.1016/0168-583X(88)90063-8</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
